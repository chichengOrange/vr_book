<?xml version="1.0" encoding="UTF-8"?>
<table sqlname="vr_ontime">

	<operation name="insert">
		<sql>
			INSERT INTO vr_ontime(
				ID,
				USER_ID,
				START_TIME,
				END_TIME,
				IMEI,
				QUIT_INTERFACE,
				GMT_CREATE,
				GMT_MODIFIED
			)VALUES(
				?,?,CURRENT_TIMESTAMP,?,?,?,CURRENT_TIMESTAMP,CURRENT_TIMESTAMP
			)
		</sql>
	</operation>
	
	<!-- 查询用户最近一条使用 -->
	<operation name="queryByUserId">
		<extraparams>
			<param name="userId" javatype="java.lang.String"/>
			<param name="imei" javatype="java.lang.String"/>
		</extraparams>
		<sql>
			SELECT * FROM vr_ontime
		</sql>
		<sqlmap>
			SELECT
				ID,
				USER_ID,
				START_TIME,
				END_TIME,
				IMEI,
				QUIT_INTERFACE,
				GMT_CREATE,
				GMT_MODIFIED
			FROM vr_ontime
			WHERE 1=1
			<isNotEmpty property="userId" prepend="and">
					USER_ID = #userId#
			</isNotEmpty>
			<isNotEmpty property="imei" prepend="and">
					IMEI = #imei#
			</isNotEmpty>
			ORDER BY GMT_MODIFIED DESC
			LIMIT 0,1
		</sqlmap>
	</operation>
	
	<!-- 添加退出时间和退出界面 -->
	<operation name="updateByUserId">
		<sql>
			UPDATE vr_ontime SET 
			GMT_MODIFIED = CURRENT_TIMESTAMP,
			END_TIME = CURRENT_TIMESTAMP,
			QUIT_INTERFACE = ?
			WHERE ID = ?
		</sql>
		
	</operation>

</table>