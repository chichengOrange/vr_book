<?xml version="1.0" encoding="GB2312" ?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN" "http://www.ibatis.com/dtd/sql-map-2.dtd">

<!-- ==========================================================  -->
<!-- Configuration for ibatis sqlmap mapping.                    -->
<!-- ==========================================================  -->

<!-- ============================================================================= -->
<!-- This file is generated by <tt>onway-gen-dal</tt>, a DAL (Data Access Layer)    -->
<!-- code generation utility specially developed for <tt>onway</tt> project.        -->
<!--                                                                               -->
<!-- PLEASE DO NOT MODIFY THIS FILE MANUALLY, or else your modification may be     -->
<!-- OVERWRITTEN by someone else. To modify the file, you should go to directory   -->
<!-- <tt>(project-home)/biz/dal/src/conf/dalgen</tt>, and find the corresponding   -->
<!-- configuration files. Modify those files according to your needs, then run     -->
<!-- <tt>onway-gen-dal</tt> to generate this file.                                  -->
<!--                                                                               -->
<!-- @author guangdong.li                                                             -->
<!-- ============================================================================= -->

<sqlMap namespace="onway">
    <!-- ============================================= -->
    <!-- RESULT MAPS                                   -->
    <!-- ============================================= -->

    <!-- result maps for database table dxs_media -->
    <resultMap id="RM-MEDIA" class="com.onway.dxsmng.common.dal.dataobject.MediaDO">
		<result property="id" column="ID"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="upUserId" column="UP_USER_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="mediaId" column="MEDIA_ID"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="mediaUrl" column="MEDIA_URL"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="mediaName" column="MEDIA_NAME"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="mediaProfile" column="MEDIA_PROFILE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="buyCount" column="BUY_COUNT"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="mediaPrice.cent" column="MEDIA_PRICE"  javaType="long" jdbcType="DECIMAL" />
		<result property="rank" column="RANK"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="timeLength" column="TIME_LENGTH"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="viewCount" column="VIEW_COUNT"  javaType="int" jdbcType="INT"  nullValue="0"/>
		<result property="viewUrl" column="VIEW_URL"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="type" column="TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="netType" column="NET_TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="mediaType" column="MEDIA_TYPE"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="recommendFlg" column="RECOMMEND_FLG"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="status" column="STATUS"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="upDown" column="UP_DOWN"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="creater" column="CREATER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="gmtCreate" column="GMT_CREATE"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="modifier" column="MODIFIER"  javaType="java.lang.String" jdbcType="VARCHAR" />
		<result property="gmtModified" column="GMT_MODIFIED"  javaType="java.util.Date" jdbcType="DATETIME" />
		<result property="memo" column="MEMO"  javaType="java.lang.String" jdbcType="VARCHAR" />
    </resultMap>


    <!-- ============================================= -->
    <!-- mapped statements for IbatisMediaDAO -->
    <!-- ============================================= -->
    <!-- mapped statement for IbatisMediaDAO.selectallmedia -->
	<select id="MS-MEDIA-SELECTALLMEDIA" resultClass="java.util.HashMap">
	        select dm.*,du.NICK_NAME from 
				dxs_media dm 
				left join dxs_user du on dm.UP_USER_ID = du.USER_ID
				
				where 1=1 
				<isNotEmpty property="nickname">
	    			AND du.NICK_NAME like '%$nickname$%'
	    		</isNotEmpty>
	    		<isNotEmpty property="mediaid">
	    			AND dm.MEDIA_ID like '%$mediaid$%'
	    		</isNotEmpty>
	    		<isNotEmpty property="medianame">
	    			AND dm.MEDIA_NAME like '%$medianame$%'
	    		</isNotEmpty>
	    		<isNotEmpty property="recommendflg">
	    			AND dm.RECOMMEND_FLG = #recommendflg#
	    		</isNotEmpty>
	    		<isNotEmpty property="status">
	    			AND dm.STATUS = #status#
	    		</isNotEmpty>
	    		<isNotEmpty property="type">
	    			AND dm.MEDIA_TYPE = #type#
	    		</isNotEmpty>
	    		<isNotEmpty property="upDown">
	    			AND dm.UP_DOWN = #upDown#
	    		</isNotEmpty>
	    		order by dm.GMT_CREATE desc 
	    		LIMIT $offset$, $limit$
    </select>

    <!-- mapped statement for IbatisMediaDAO.selectallmediacount -->
			 <select id="MS-MEDIA-SELECTALLMEDIACOUNT" resultClass="int">
	        select count(1) from 
				dxs_media dm 
				left join dxs_user du on dm.UP_USER_ID = du.USER_ID
				
				where 1=1 
				<isNotEmpty property="nickname">
	    			AND du.NICK_NAME like '%$nickname$%'
	    		</isNotEmpty>
	    		<isNotEmpty property="mediaid">
	    			AND dm.MEDIA_ID like '%$mediaid$%'
	    		</isNotEmpty>
	    		<isNotEmpty property="medianame">
	    			AND dm.MEDIA_NAME like '%$medianame$%'
	    		</isNotEmpty>
	    		<isNotEmpty property="recommendflg">
	    			AND dm.RECOMMEND_FLG = #recommendflg#
	    		</isNotEmpty>
	    		<isNotEmpty property="status">
	    			AND dm.STATUS = #status#
	    		</isNotEmpty>
	    		<isNotEmpty property="type">
	    			AND dm.MEDIA_TYPE = #type#
	    		</isNotEmpty>
	    		<isNotEmpty property="upDown">
	    			AND dm.UP_DOWN = #upDown#
	    		</isNotEmpty>
    </select>

    <!-- mapped statement for IbatisMediaDAO.updatemedia -->
    <update id="MS-MEDIA-UPDATEMEDIA">
        update dxs_media set $filed$ = #value#,modifier = #modifier# ,GMT_MODIFIED = #gmtmodifier#
				<isNotEmpty property="type">
	    			,memo = #memo#
	    		</isNotEmpty>
	    		<isNotEmpty property="length">
	    			,TIME_LENGTH = #length#
	    		</isNotEmpty>
	    		<isNotEmpty property="netType">
	    			,NET_TYPE = #netType# 
	    		</isNotEmpty>
	    		where id=#id#
    </update>

    <!-- mapped statement for IbatisMediaDAO.selectById -->
			 <select id="MS-MEDIA-SELECT-BY-ID" resultMap="RM-MEDIA">
	    <![CDATA[
        select * from dxs_media where (id = #value#)
    ]]>
    </select>

    <!-- mapped statement for IbatisMediaDAO.changeMediaInfo -->
    <update id="MS-MEDIA-CHANGE-MEDIA-INFO">
    <![CDATA[
        update dxs_media set BUY_COUNT=#buyCount#, RANK=#rank#, VIEW_COUNT=#viewCount#, TYPE=#type#, MEDIA_NAME=#mediaName#, MEDIA_PROFILE=#mediaProfile#, MEMO=#memo#, MODIFIER=#modifier#, GMT_MODIFIED=CURRENT_TIMESTAMP where (MEDIA_ID = #mediaId#)
    ]]>
    </update>

    <!-- mapped statement for IbatisMediaDAO.changeMediaUrl -->
    <update id="MS-MEDIA-CHANGE-MEDIA-URL">
    <![CDATA[
        update dxs_media set MEDIA_URL=#mediaUrl#, MODIFIER=#modifier#, NET_TYPE=#netType#, GMT_MODIFIED=CURRENT_TIMESTAMP where (ID = #id#)
    ]]>
    </update>

    <!-- mapped statement for IbatisMediaDAO.changeMediaView -->
    <update id="MS-MEDIA-CHANGE-MEDIA-VIEW">
    <![CDATA[
        update dxs_media set VIEW_URL=#viewUrl#, MODIFIER=#modifier#, GMT_MODIFIED=CURRENT_TIMESTAMP where (ID = #id#)
    ]]>
    </update>

    <!-- mapped statement for IbatisMediaDAO.changeMediaPrice -->
    <update id="MS-MEDIA-CHANGE-MEDIA-PRICE">
    <![CDATA[
        update dxs_media set MEDIA_PRICE=#mediaPrice.cent#, MODIFIER=#modifier#, GMT_MODIFIED=CURRENT_TIMESTAMP where (ID = #id#)
    ]]>
    </update>

    <!-- mapped statement for IbatisMediaDAO.selectByMediaId -->
			 <select id="MS-MEDIA-SELECT-BY-MEDIA-ID" resultClass="java.util.HashMap">
	        select  
				  u.NICK_NAME NICK_NAME
				from 
				dxs_media m
				left join dxs_user u on m.UP_USER_ID = u.USER_ID
				where m.MEDIA_ID = #mediaId#
    </select>

</sqlMap>