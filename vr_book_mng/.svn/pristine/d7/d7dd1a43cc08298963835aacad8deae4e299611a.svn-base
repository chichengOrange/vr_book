<?xml version="1.0" encoding="UTF-8"?>
<table sqlname="vr_user">
<!-- 添加用户 -->
<operation name="adduser" >
	<sql>
		insert into vr_user
		(USER_ID,USER_NAME,OPEN_ID,HEAD_URL,CELL,PSW,PROVINCE,CITY,AREA,STATUS,GMT_CREATE,GMT_MODIFIED)
		values(?,?,?,?,?,?,?,?,?,?,CURRENT_TIMESTAMP,CURRENT_TIMESTAMP)
	</sql>
</operation>


<!-- 查询用户 -->
<operation name="selectuser" resultClass="java.util.HashMap" multiplicity="many">
	<extraparams>
		<param name="userName" javatype="java.lang.String"/>
		<param name="cell" javatype="java.lang.String"/>
		<param name="status" javatype="java.lang.String"/>
		<param name="offset" javatype="int" />
		<param name="limit" javatype="int" />
	</extraparams>
	<sql>
		select * from vr_user where 1 = 1
	</sql>
	<sqlmap>
		<![CDATA[
		select 
		ID id, USER_ID userId, USER_NAME userName,HEAD_URL headUrl,CELL cell,STATUS status,PROVINCE province,CITY city,AREA area,GMT_CREATE gmtCreate,GMT_MODIFIED gmtModified
		from vr_user
		where 1 = 1
		
		<isNotEmpty prepend="and" property="userName">
			USER_NAME like '%$userName$%'
		</isNotEmpty>
		
		<isNotEmpty prepend="and" property="cell">
			CELL like '%$cell$%'
		</isNotEmpty>
		
		<isNotEmpty prepend="and" property="status">
			STATUS = #status#
		</isNotEmpty>
		
		limit #offset#,#limit#
		
		]]>
	</sqlmap>
</operation>

<!-- 获取分页数量 -->

<operation name="queryListCount" resultclass="int">
	<extraparams>
		<param name="userName" javatype="java.lang.String"/>
		<param name="cell" javatype="java.lang.String"/>
		<param name="status" javatype="java.lang.String"/>
	</extraparams>
	<sql>
		SELECT COUNT(1) FROM vr_user where 1=1
	</sql>
	<sqlmap>
		<![CDATA[
			SELECT COUNT(1) FROM vr_user where 1=1
			
			<isNotEmpty prepend="and" property="userName">
			USER_NAME like '%$userName$%'
			</isNotEmpty>
			
			<isNotEmpty prepend="and" property="cell">
				CELL like '%$cell$%'
			</isNotEmpty>
			
			<isNotEmpty prepend="and" property="status">
				STATUS = #status#
			</isNotEmpty>
		]]>
	</sqlmap>
</operation>

<!-- 根据id删除用户 -->
<operation name="deletUserbyid">
	<sql>
		delete from vr_user where ID=?
	</sql>
</operation>
<!-- 查询今日新增用户 -->
<operation name="selectTodayUser">
	<sql>
		select COUNT(1) FROM vr_user 
	</sql>
		<sqlmap>
		<![CDATA[
			select COUNT(1) FROM vr_user WHERE DATEDIFF(GMT_CREATE,NOW()) = 0
		]]>
	</sqlmap>
</operation>
<!-- 查询本月新增用户 -->
<operation name="selectMonthUser">
	<sql>
		select COUNT(1) FROM vr_user 
	</sql>
		<sqlmap>
		<![CDATA[
			select COUNT(1) FROM vr_user  WHERE DATE_FORMAT(  GMT_CREATE, '%Y%m' ) = DATE_FORMAT( CURDATE( ) , '%Y%m' )
		]]>
	</sqlmap>
</operation>
<!-- 查询本季度新增用户 -->
<operation name="selectQuarterUser">
	<sql>
		select COUNT(1) FROM vr_user 
	</sql>
		<sqlmap>
		<![CDATA[
			select COUNT(1) from vr_user where QUARTER(GMT_CREATE)=QUARTER(now())
		]]>
	</sqlmap>
</operation>
</table>